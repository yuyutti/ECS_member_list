<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="icon" href="favicon.ico">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
        <title>LauRo-Espoets メンバーリスト</title>
    </head>
    <body style="font-size: 135%">
        <div class="container my-3 p-3 bg-body rounded">
            <table class="table">
                <thead class="sticky-top" style="background-color: #fff">
                    <tr class="text-center">
                            <th scope="col">活動名</th>
                            <th scope="col">EpicID</th>
                            <th scope="col">PR</th>
                            <th scope="col">PP</th>
                            <th scope="col">PR-ZB</th>
                            <th scope="col">PP-ZB</th>
                    </tr>
                </thead>
                <tbody id="send_data"></tbody>
            </table>
            <p id="Loading" class="text-center fs-1">Now Loading...</p>
        </div>
        <script src="https://code.jquery.com/jquery-3.7.0.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    </body>
    <script>
        const req_interval = 1000;
        function req() {
            $.ajax({
                url: 'https://member.ecs-esports.com/data',
                type: 'GET',
                success: function(response, status, xhr) {
                    if (xhr.status === 200) {
                        $(document).ready(function() {
                            const tableBody = $('#send_data');
                            let html = '';
                            response.forEach(item => {
                                html += `
                                    <tr>
                                        <td class="text-center align-middle"><a href="${item.TrackerURL}" target="_blank" rel="noopener noreferrer" class="link-info">${item.playername}</a></td>
                                        <td class="text-center">${item.EpicID}<br>${item.EpicIDmanagement}</td>
                                        <td class="text-center align-middle">${item.PowerRanking}</td>
                                        <td class="text-center align-middle">${item.powerpoint}</td>
                                        <td class="text-center align-middle">${item.PowerRankingZB}</td>
                                        <td class="text-center align-middle">${item.powerpointZB}</td>
                                    </tr>
                                `;
                            });
                            $('#Loading').hide();
                            tableBody.html(html);
                        });
                    } 
                },
                error: function(xhr, status, error) {
                    if (xhr.status === 400) {
                        setTimeout(req, req_interval);
                    }
                }
            });
        }
        req()
    </script>
</html>